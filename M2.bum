<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<org.eventb.core.machineFile org.eventb.core.configuration="org.eventb.core.fwd" org.eventb.core.generated="false" org.eventb.texttools.text_lastmodified="1741094220530" org.eventb.texttools.text_representation="machine M2 refines M1  sees C_Decomposition&#10;&#10;variables offers // current service' offers these services are modelled as capabilities based on the capability model&#10;response // the response returned to the user&#10;requestedCapability  // the requested offer&#10;variantsOf //the set of current relationships between offers&#10;variantsOfByCategory // set of variantsOf grouped by their actionCategory&#10; offersByCategory //&#10;&#10;          /*&#10;             this is the second refinement:&#10;             decomposition of offers by category and variantsOf by categorys. Now we have a global graph G(offers,variantsOf)&#10;             where offers represent the nodes of G and variantsOf are the set of edges&#10;             and subGraphs for each each actionCategory&#10;             g_action_i(offersByCategory(action_i),(variantsOfByCategory(action_i))&#10;            where offersByCategory(action_i) represent the nodes of g_action_i and variantsOfByCategory(action_i)&#10;             are the set of edges of g_action_i&#10;              */&#10;&#10;/* terminology : variantsOf: all variantOf relationships between offers we can call it also edges of global graph */&#10;invariants&#10;  @inv1 variantsOfByCategory ∈ ℙ(GENERALVALUES)⇸ ℙ(variantOf) // variantsOfByCategory is a partial relation from a subset of GENERALVALUES to a subset of variantOf&#10;  @inv2 union(ran(variantsOfByCategory))=variantsOf //the union of subgraphs' edges is the edges of the global graph&#10;  @inv3 offersByCategory ∈ ℙ(GENERALVALUES)⇸ ℙ(Capability_valid) //offersByCategory is a partial relation from a subset of GENERALVALUES to a subset of offers&#10;  @inv4 ∀a,c·  a ∈ dom(offersByCategory) ∧ c ∈ offersByCategory(a) ⇒  getActionCategory(c)=a /*if a is a value for the actionCategory property(a is subset of GENERALVALUES) and&#10;  c is an offer that belongs to offersByCategory(a) then the value of the actionCategory property of c is equals to a. This means all elements in the same offersByCategory(a),&#10;  the value of their actionCategory property is a   */&#10;  @inv5 union(ran(offersByCategory))=offers // the union of subgraphs' nodes is the set of global nodes(offers)&#10;  @inv7 ∀a· a ∈ ℙ(GENERALVALUES) ∧ a ∈ dom(variantsOfByCategory)∧ a ∈ dom(offersByCategory)&#10; &#9;&#9; ⇒ variantsOfByCategory(a)={c1↦c2∣c1 ∈ offersByCategory(a) ∧ c2∈ offersByCategory(a) ∧&#10;  &#9;&#9;&#9; c1↦c2 ∈ variantsOf}// the set of edges for each subgraph is the set of edges in the global graph where nodes are in the same subgraph&#10;  @inv8 requestedCapability≠∅ ∧ getActionCategory(requestedCapability) ∈ dom(offersByCategory) ∧&#10;  requestedCapability ∈ offersByCategory(getActionCategory(requestedCapability)) ⇒ response = {requestedCapability}// in inv4a in m1 requestedCapability ∈ offers becomes requestedCapability ∈ offersByCategory having as actionCategory the same as requestCapability&#10;  @inv9 requestedCapability≠∅ ∧ getActionCategory(requestedCapability) ∈ dom(offersByCategory) ∧&#10;  requestedCapability ∉ offersByCategory(getActionCategory(requestedCapability))  ⇒&#10;  response ={offer ∣ offer ∈ offersByCategory(getActionCategory(requestedCapability)) ∧&#10;  requestedCapability↦offer ∈ variantOf} //in inv4b in M1 requestedCapability∉ offers becomes requestedCapability∉ offersByCategory having the same actionCategory as the requestedCapability&#10;  @inv10 requestedCapability= ∅ ∨ requestedCapability ∈ Capability_valid // request is empty or s valid capability&#10;  theorem @inv11 ∀a,b· a∈ℙ(GENERALVALUES)∧ b∈ℙ(GENERALVALUES)∧&#10;                 a∈ dom(offersByCategory)∧ b∈ dom(offersByCategory)&#10;                 ⇒(a≠b⇒offersByCategory(a)∩offersByCategory(b)=∅) // intersection between offersByCategory is the empty set&#10;  theorem @inv12 ∀a,b· a∈ℙ(GENERALVALUES)∧ b∈ℙ(GENERALVALUES)∧&#10;                 a∈ dom(variantsOfByCategory)∧ b∈ dom(variantsOfByCategory)∧a∈ dom(offersByCategory)∧ b∈ dom(offersByCategory)&#10;                 ⇒(a≠b⇒variantsOfByCategory(a)∩variantsOfByCategory(b)=∅)  // intersection between variantsOfByCategory is the empty set&#10;//@inv5 and @inv11 prove that each offersByCategory is a partition of offers&#10;//@inv2 and @inv12 prove that each variantsOfByCategory is a partition of variants&#10;//Thus the global graph is decomposed into many subgraphs that are disconnected and we proved the global graph is the composition of all subgraphs&#10;events&#10;  event INITIALISATION extends INITIALISATION&#10;    then&#10;      @act5 variantsOfByCategory ≔ {∅↦∅} //offers is empty set and variantsOf is empty set then variantsOfByCategory is {∅↦∅}&#10;      @act6 offersByCategory ≔ {∅↦∅} //offers is empty set  then offersByCategory is {∅↦∅}&#10;  end&#10;&#10;  event addOfferWhenRequestIsEqualToOffer // adding new offer case: when request is equals to the new offer response is updated and becomes {offer}&#10;   refines addOfferWhenRequestIsEqualToOffer&#10;    any offer&#10;    where&#10;      @grd1 offer ∈ Capability_valid // offer must be a valid capability&#10;      @grd_wd getActionCategory(offer)∈ dom(variantsOfByCategory)&#10;      @grd_wd2 getActionCategory(offer)∈ dom(offersByCategory)&#10;      @grd2 offer ∉ offersByCategory(getActionCategory(offer)) // offer does not already exist in the graph having same actionCategory&#10;      @grd3 offer = requestedCapability&#10;    then&#10;      @act1 offers≔ offers ∪{offer} // add offer to exissting offers&#10;      @act2 response ≔ {offer} // update offer as offer=requestedCapability and response={requestedCapability} then response= {offer}&#10;      @act3 variantsOf≔ variantsOf ∪ addNewVariantsOf(offers↦offer) // add new relationships&#10;      @act4 variantsOfByCategory≔ variantsOfByCategory   &#10;            {getActionCategory(offer)↦&#10;            (variantsOfByCategory(getActionCategory(offer))∪addNewVariantsOf(offers↦offer)) }/* variantOf relationships with the new offer and offers&#10;            are added to the corresponding variantsOfByCategory. addNewVariantsOf will add only variantOf relationships between offer and offers in the same category. this is guarantee by the definitionof the variantOf relation*/&#10;      @act5 offersByCategory≔ offersByCategory   &#10;            {getActionCategory(offer)↦offersByCategory(getActionCategory(offer))∪{offer} } //  offer is  added to the corresponding offersByCategory&#10;  end&#10;&#10;  event addOfferWhenOfferIsVariantOfRequest refines addOfferWhenOfferIsVariantOfRequest&#10;     any offer&#10;    where&#10;      @grd1 offer ∈ Capability_valid // offer must be a valid capability&#10;      @grd_wd getActionCategory(offer)∈ dom(variantsOfByCategory)&#10;      @grd_wd2 getActionCategory(offer)∈ dom(offersByCategory)&#10;      @grd2 offer ∉ offersByCategory(getActionCategory(offer)) // offer does not already exist in the graph having same actionCategory&#10;       @grd3 requestedCapability↦offer ∈ variantOf&#10;      @grd4 requestedCapability ∉ offersByCategory(getActionCategory(offer))&#10;    then&#10;      @act1 offers ≔ offers ∪ {offer}&#10;      @act2 response ≔ response ∪ {offer}&#10;      @act3 variantsOf≔ variantsOf ∪ addNewVariantsOf(offers↦offer)&#10;      @act4 variantsOfByCategory≔ variantsOfByCategory   &#10;            {getActionCategory(offer)↦(variantsOfByCategory(getActionCategory(offer))∪addNewVariantsOf(offers↦offer)) }&#10;      @act5 offersByCategory≔ offersByCategory   &#10;            {getActionCategory(offer)↦offersByCategory(getActionCategory(offer))∪{offer} } // add new offer two its category&#10;&#10;  end&#10;&#10;  event addOffer refines addOffer&#10;   &#9;any offer&#10;   &#9;where&#10;      @grd1 offer ∈ Capability_valid // offer must be a valid capability&#10;      @grd_wd getActionCategory(offer)∈ dom(variantsOfByCategory)&#10;      @grd_wd2 getActionCategory(offer)∈ dom(offersByCategory)&#10;      @grd2 offer ∉ offersByCategory(getActionCategory(offer))&#10;      @grd3 requestedCapability↦offer ∉ variantOf&#10;      @grd4 offer ≠ requestedCapability&#10;      @grd5 requestedCapability ∈  Capability_valid ∨ requestedCapability=∅&#10;      @grd6 requestedCapability≠∅ ⇒ getActionCategory(requestedCapability)∈ dom(offersByCategory)&#10;   &#9;then&#10;      @act1 offers ≔ offers ∪ {offer}&#10;      @act2 variantsOf≔ variantsOf ∪ addNewVariantsOf(offers↦offer)&#10;      @act3 variantsOfByCategory≔ variantsOfByCategory   &#10;            {getActionCategory(offer)↦(variantsOfByCategory(getActionCategory(offer))∪addNewVariantsOf(offers↦offer)) }&#10;      @act4 offersByCategory≔ offersByCategory   &#10;            {getActionCategory(offer)↦offersByCategory(getActionCategory(offer))∪{offer} } // add new offer to its category&#10;&#10;  end&#10;&#10;  event removeOffer refines removeOffer&#10;    any offer&#10;    where&#10;      @grd1 offer ∈ Capability_valid // offer must be a valid capability&#10;      @grd_wd getActionCategory(offer)∈ dom(variantsOfByCategory)&#10;      @grd_wd2 getActionCategory(offer)∈ dom(offersByCategory)&#10;      @grd2 offer ∈ offersByCategory(getActionCategory(offer))&#10;      @grd3 offer ∉ response&#10;      @grd4 ∀a· a∈dom(variantsOfByCategory)⇒  a∈ dom(offersByCategory)&#10;    then&#10;      @act1 offers≔ offers ∖{offer}&#10;      @act2 variantsOf≔ variantsOf ∖ addNewVariantsOf(offers↦offer)&#10;      @act3 variantsOfByCategory≔ variantsOfByCategory   &#10;            {getActionCategory(offer)↦(variantsOfByCategory(getActionCategory(offer))∖addNewVariantsOf(offers↦offer)) }&#10;      @act4 offersByCategory≔ offersByCategory   &#10;            {getActionCategory(offer)↦offersByCategory(getActionCategory(offer))∖{offer} } // add new offer two its category&#10;&#10;  end&#10;&#10;  event removeOfferWhenOfferIsInResponseAndEqualsRequest refines removeOfferWhenOfferIsInResponseAndEqualsRequest&#10;    any offer&#10;    where&#10;      @grd1 offer ∈ Capability_valid // offer must be a valid capability&#10;      @grd_wd getActionCategory(offer)∈ dom(variantsOfByCategory)&#10;      @grd_wd2 getActionCategory(offer)∈ dom(offersByCategory)&#10;      @grd2 offer ∈ offersByCategory(getActionCategory(offer))&#10;      @grd3 offer ∈  response&#10;      @grd4 requestedCapability ∈ offers∖ {offer}&#10;    then&#10;      @act1 offers≔ offers ∖{offer}&#10;      @act2 variantsOf≔ variantsOf ∖ addNewVariantsOf(offers↦offer)&#10;      @act3 response≔ {requestedCapability}&#10;      @act4 variantsOfByCategory≔ variantsOfByCategory   &#10;            {getActionCategory(offer)↦(variantsOfByCategory(getActionCategory(offer))∖addNewVariantsOf(offers↦offer)) }&#10;      @act5 offersByCategory≔ offersByCategory   &#10;            {getActionCategory(offer)↦offersByCategory(getActionCategory(offer))∖{offer} } // add new offer two its category&#10;&#10;  end&#10;&#10;  event removeOfferWhenOfferIsInResponseAndNotEqualToRequest refines removeOfferWhenOfferIsInResponseAndNotEqualToRequest&#10;    any offer&#10;    where&#10;      @grd1 offer ∈ Capability_valid // offer must be a valid capability&#10;      @grd_wd getActionCategory(offer)∈ dom(variantsOfByCategory)&#10;      @grd_wd2 getActionCategory(offer)∈ dom(offersByCategory)&#10;      @grd2 requestedCapability ∈  Capability_valid&#10;      @grd_wd3 getActionCategory(requestedCapability)∈ dom(offersByCategory)&#10;      @grd3 offer ∈ offersByCategory(getActionCategory(offer))&#10;      @grd4 offer ∈  response&#10;      @grd5 requestedCapability ∉ offersByCategory(getActionCategory(requestedCapability))∖ {offer}&#10;      @grd6 ∀a· a∈dom(variantsOfByCategory)⇒  a∈ dom(offersByCategory)&#10;    then&#10;      @act1 offers≔ offers ∖{offer}&#10;      @act2 variantsOf≔ variantsOf ∖ addNewVariantsOf(offers↦offer)&#10;      @act3 response≔  {offer0 ∣ offer0 ∈ offersByCategory(getActionCategory(requestedCapability))∖{offer} ∧ requestedCapability↦offer0 ∈ variantOf}&#10;      @act4 variantsOfByCategory≔ variantsOfByCategory   &#10;            {getActionCategory(offer)↦(variantsOfByCategory(getActionCategory(offer))∖addNewVariantsOf(offers↦offer)) }&#10;      @act5 offersByCategory≔ offersByCategory   &#10;            {getActionCategory(offer)↦offersByCategory(getActionCategory(offer))∖{offer} } // add new offer two its category&#10;&#10;  end&#10;&#10;  event getOffersForNewRequestWhenRequestIsInOffer refines getOffersForNewRequestWhenRequestIsInOffer&#10;    any request&#10;    where&#10;      @grd1 request ∈ Capability_valid&#10;      @grd_wd2 getActionCategory(request)∈ dom(offersByCategory)&#10;      @grd2 request ∈  offersByCategory(getActionCategory(request))&#10;    then&#10;      @act1 requestedCapability ≔ request&#10;      @act2 response≔ {request} // ∨  { request↦offer ∈ variantsOf})&#10;  end&#10;&#10;  event getOffersForNewRequestWhenRequestIsNotInOffer refines getOffersForNewRequestWhenRequestIsNotInOffer&#10;    any request&#10;    where&#10;      @grd1 request ∈ Capability_valid&#10;      @grd_wd2 getActionCategory(request)∈ dom(offersByCategory)&#10;      @grd2 request ∉  offersByCategory(getActionCategory(request))&#10;    then&#10;      @act1 requestedCapability ≔ request&#10;      @act2 response≔ {offer ∣ offer ∈ offersByCategory(getActionCategory(request)) ∧ request↦offer ∈ variantOf}&#10;  end&#10;end&#10;" version="5">
    <org.eventb.core.refinesMachine name="'" org.eventb.core.target="M1"/>
    <org.eventb.core.seesContext name="_78FOQOv2Ee-SG5eiYj37kA" org.eventb.core.target="C_Decomposition"/>
    <org.eventb.core.variable name="_t0-X9On5Ee-FCLy2ldeH6A" org.eventb.core.comment="current service' offers these services are modelled as capabilities based on the capability model" org.eventb.core.generated="false" org.eventb.core.identifier="offers"/>
    <org.eventb.core.variable name="_t0-_AOn5Ee-FCLy2ldeH6A" org.eventb.core.comment="the response returned to the user" org.eventb.core.generated="false" org.eventb.core.identifier="response"/>
    <org.eventb.core.variable name="_t0-_Aen5Ee-FCLy2ldeH6A" org.eventb.core.comment="the requested offer" org.eventb.core.generated="false" org.eventb.core.identifier="requestedCapability"/>
    <org.eventb.core.variable name="_t077sOn5Ee-FCLy2ldeH6M" org.eventb.core.comment="the set of current relationships between offers" org.eventb.core.generated="false" org.eventb.core.identifier="variantsOf"/>
    <org.eventb.core.variable name="_t0-_Aun5Ee-FCLy2ldeH6A" org.eventb.core.comment="set of variantsOf grouped by their actionCategory" org.eventb.core.generated="false" org.eventb.core.identifier="variantsOfByCategory"/>
    <org.eventb.core.event name="_t077sOn5Ee-FCLy2ldeH6B" org.eventb.core.convergence="0" org.eventb.core.extended="true" org.eventb.core.generated="false" org.eventb.core.label="INITIALISATION">
        <org.eventb.core.action name="'" org.eventb.core.assignment="variantsOfByCategory ≔ {∅↦∅}" org.eventb.core.comment="offers is empty set and variantsOf is empty set then variantsOfByCategory is {∅↦∅}" org.eventb.core.generated="false" org.eventb.core.label="act5"/>
        <org.eventb.core.action name="_Lo9jMOu9Ee-Y0dp7YSmiGQ" org.eventb.core.assignment="offersByCategory ≔ {∅↦∅}" org.eventb.core.comment="offers is empty set  then offersByCategory is {∅↦∅}" org.eventb.core.generated="false" org.eventb.core.label="act6"/>
    </org.eventb.core.event>
    <org.eventb.core.event name="_t077sOn5Ee-FCLy2ldeH6C" org.eventb.core.comment="adding new offer case: when request is equals to the new offer response is updated and becomes {offer}" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="addOfferWhenRequestIsEqualToOffer">
        <org.eventb.core.refinesEvent name="'" org.eventb.core.target="addOfferWhenRequestIsEqualToOffer"/>
        <org.eventb.core.parameter name="_jXc7oOpmEe-FCLy2ldeH6A" org.eventb.core.comment="a service' offer described based on the capability model" org.eventb.core.generated="false" org.eventb.core.identifier="offer"/>
        <org.eventb.core.guard name="_jXdisOpmEe-FCLy2ldeH6A" org.eventb.core.comment="offer must be a valid capability" org.eventb.core.generated="false" org.eventb.core.label="grd1" org.eventb.core.predicate="offer ∈ Capability_valid"/>
        <org.eventb.core.guard name="_uJSF4Oq7Ee-Y0dp7YSmiGR" org.eventb.core.generated="false" org.eventb.core.label="grd_wd" org.eventb.core.predicate="getActionCategory(offer)∈ dom(variantsOfByCategory)"/>
        <org.eventb.core.guard name="_Dbil0OxtEe-SG5eiYj37kA" org.eventb.core.generated="false" org.eventb.core.label="grd_wd2" org.eventb.core.predicate="getActionCategory(offer)∈ dom(offersByCategory)"/>
        <org.eventb.core.guard name="_jXdisepmEe-FCLy2ldeH6A" org.eventb.core.comment="offer does not already exist in the graph having same actionCategory" org.eventb.core.generated="false" org.eventb.core.label="grd2" org.eventb.core.predicate="offer ∉ offersByCategory(getActionCategory(offer))"/>
        <org.eventb.core.guard name="_jXeJwOpmEe-FCLy2ldeH6A" org.eventb.core.generated="false" org.eventb.core.label="grd3" org.eventb.core.predicate="offer = requestedCapability"/>
        <org.eventb.core.action name="_Owv0YOrJEe-Y0dp7YSmiGQ" org.eventb.core.assignment="offers≔ offers ∪{offer}" org.eventb.core.comment="add offer to exissting offers" org.eventb.core.generated="false" org.eventb.core.label="act1"/>
        <org.eventb.core.action name="_VeGUQOpoEe-Y0dp7YSmiGQ" org.eventb.core.assignment="response ≔ {offer}" org.eventb.core.comment="update offer as offer=requestedCapability and response={requestedCapability} then response= {offer}" org.eventb.core.generated="false" org.eventb.core.label="act2"/>
        <org.eventb.core.action name="_uJSF4Oq7Ee-Y0dp7YSmiGQ" org.eventb.core.assignment="variantsOf≔ variantsOf ∪ addNewVariantsOf(offers↦offer)" org.eventb.core.comment="add new relationships" org.eventb.core.generated="false" org.eventb.core.label="act3"/>
        <org.eventb.core.action name="_jXeJxOpmEe-FCLy2ldeH6A" org.eventb.core.assignment="variantsOfByCategory≔ variantsOfByCategory   &#10;            {getActionCategory(offer)↦&#10;            (variantsOfByCategory(getActionCategory(offer))∪addNewVariantsOf(offers↦offer)) }" org.eventb.core.comment="variantOf relationships with the new offer and offers&#10;            are added to the corresponding variantsOfByCategory. addNewVariantsOf will add only variantOf relationships between offer and offers in the same category. this is guarantee by the definitionof the variantOf relation" org.eventb.core.generated="false" org.eventb.core.label="act4"/>
        <org.eventb.core.action name="_wFFiAOu9Ee-Y0dp7YSmiGQ" org.eventb.core.assignment="offersByCategory≔ offersByCategory   &#10;            {getActionCategory(offer)↦offersByCategory(getActionCategory(offer))∪{offer} }" org.eventb.core.comment="offer is  added to the corresponding offersByCategory" org.eventb.core.generated="false" org.eventb.core.label="act5"/>
    </org.eventb.core.event>
    <org.eventb.core.event name="_t077sOn5Ee-FCLy2ldeH6D" org.eventb.core.comment="adding new offer case: when request is variantOf  the new offer and request is not in offers  then offer  is added to response" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="addOfferWhenOfferIsVariantOfRequest">
        <org.eventb.core.refinesEvent name="'" org.eventb.core.target="addOfferWhenOfferIsVariantOfRequest"/>
        <org.eventb.core.parameter name="_BGTJcO3xEe-riu9HV7xa5A" org.eventb.core.comment="a service' offer described based on the capability model" org.eventb.core.generated="false" org.eventb.core.identifier="offer"/>
        <org.eventb.core.guard name="_ou4m0OrIEe-Y0dp7YSmiGQ" org.eventb.core.comment="offer must be a valid capability" org.eventb.core.generated="false" org.eventb.core.label="grd1" org.eventb.core.predicate="offer ∈ Capability_valid"/>
        <org.eventb.core.guard name="_BGTwgO3xEe-riu9HV7xa5A" org.eventb.core.generated="false" org.eventb.core.label="grd_wd" org.eventb.core.predicate="getActionCategory(offer)∈ dom(variantsOfByCategory)"/>
        <org.eventb.core.guard name="_DbkbAOxtEe-SG5eiYj37kA" org.eventb.core.generated="false" org.eventb.core.label="grd_wd2" org.eventb.core.predicate="getActionCategory(offer)∈ dom(offersByCategory)"/>
        <org.eventb.core.guard name="_ou5N4OrIEe-Y0dp7YSmiGQ" org.eventb.core.comment="offer does not already exist in the graph having same actionCategory" org.eventb.core.generated="false" org.eventb.core.label="grd2" org.eventb.core.predicate="offer ∉ offersByCategory(getActionCategory(offer))"/>
        <org.eventb.core.guard name="_BGUXkO3xEe-riu9HV7xa5A" org.eventb.core.generated="false" org.eventb.core.label="grd3" org.eventb.core.predicate="requestedCapability↦offer ∈ variantOf"/>
        <org.eventb.core.guard name="_lbpK0O3xEe-riu9HV7xa5A" org.eventb.core.generated="false" org.eventb.core.label="grd4" org.eventb.core.predicate="requestedCapability ∉ offersByCategory(getActionCategory(offer))"/>
        <org.eventb.core.action name="_OwwbcerJEe-Y0dp7YSmiGQ" org.eventb.core.assignment="offers ≔ offers ∪ {offer}" org.eventb.core.comment="add offer to offers" org.eventb.core.generated="false" org.eventb.core.label="act1"/>
        <org.eventb.core.action name="_OwwbcOrJEe-Y0dp7YSmiGQ" org.eventb.core.assignment="response ≔ response ∪ {offer}" org.eventb.core.comment="add offer to response" org.eventb.core.generated="false" org.eventb.core.label="act2"/>
        <org.eventb.core.action name="_BGUXke3xEe-riu9HV7xa5A" org.eventb.core.assignment="variantsOf≔ variantsOf ∪ addNewVariantsOf(offers↦offer)" org.eventb.core.comment="add relationships between the new offer and existing ones" org.eventb.core.generated="false" org.eventb.core.label="act3"/>
        <org.eventb.core.action name="_BGUXku3xEe-riu9HV7xa5A" org.eventb.core.assignment="variantsOfByCategory≔ variantsOfByCategory   &#10;            {getActionCategory(offer)↦(variantsOfByCategory(getActionCategory(offer))∪addNewVariantsOf(offers↦offer)) }" org.eventb.core.comment="variantOf relationships with the new offer and offers&#10;            are added to the corresponding variantsOfByCategory. " org.eventb.core.generated="false" org.eventb.core.label="act4"/>
        <org.eventb.core.action name="_BGUXk-3xEe-riu9HV7xa5A" org.eventb.core.assignment="offersByCategory≔ offersByCategory   &#10;            {getActionCategory(offer)↦offersByCategory(getActionCategory(offer))∪{offer} }" org.eventb.core.comment="offer is  added to the corresponding offersByCategory" org.eventb.core.generated="false" org.eventb.core.label="act5"/>
    </org.eventb.core.event>
    <org.eventb.core.event name="_t077sOn5Ee-FCLy2ldeH6E" org.eventb.core.comment="adding new offer case: when request is not equals to the new offer and not variant of the new offer in this case response does not  change" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="addOffer">
        <org.eventb.core.refinesEvent name="'" org.eventb.core.target="addOffer"/>
        <org.eventb.core.parameter name="_OiAj0O31Ee-riu9HV7xa5A" org.eventb.core.comment="a service' offer described based on the capability model" org.eventb.core.generated="false" org.eventb.core.identifier="offer"/>
        <org.eventb.core.guard name="__7xkMOrIEe-Y0dp7YSmiGQ" org.eventb.core.comment="offer must be a valid capability" org.eventb.core.generated="false" org.eventb.core.label="grd1" org.eventb.core.predicate="offer ∈ Capability_valid"/>
        <org.eventb.core.guard name="_OiBK4O31Ee-riu9HV7xa5A" org.eventb.core.generated="false" org.eventb.core.label="grd_wd" org.eventb.core.predicate="getActionCategory(offer)∈ dom(variantsOfByCategory)"/>
        <org.eventb.core.guard name="_DblCEOxtEe-SG5eiYj37kA" org.eventb.core.generated="false" org.eventb.core.label="grd_wd2" org.eventb.core.predicate="getActionCategory(offer)∈ dom(offersByCategory)"/>
        <org.eventb.core.guard name="__7xkMurIEe-Y0dp7YSmiGQ" org.eventb.core.generated="false" org.eventb.core.label="grd2" org.eventb.core.predicate="offer ∉ offersByCategory(getActionCategory(offer))"/>
        <org.eventb.core.guard name="_OiDAEO31Ee-riu9HV7xa5A" org.eventb.core.generated="false" org.eventb.core.label="grd3" org.eventb.core.predicate="requestedCapability↦offer ∉ variantOf"/>
        <org.eventb.core.guard name="_OiDAEe31Ee-riu9HV7xa5A" org.eventb.core.generated="false" org.eventb.core.label="grd4" org.eventb.core.predicate="offer ≠ requestedCapability"/>
        <org.eventb.core.action name="_wFGwIOu9Ee-Y0dp7YSmiGQ" org.eventb.core.assignment="offers ≔ offers ∪ {offer}" org.eventb.core.generated="false" org.eventb.core.label="act1"/>
        <org.eventb.core.action name="_OwwbcurJEe-Y0dp7YSmiGQ" org.eventb.core.assignment="variantsOf≔ variantsOf ∪ addNewVariantsOf(offers↦offer)" org.eventb.core.generated="false" org.eventb.core.label="act2"/>
        <org.eventb.core.action name="_OiDAEu31Ee-riu9HV7xa5A" org.eventb.core.assignment="variantsOfByCategory≔ variantsOfByCategory   &#10;            {getActionCategory(offer)↦(variantsOfByCategory(getActionCategory(offer))∪addNewVariantsOf(offers↦offer)) }" org.eventb.core.generated="false" org.eventb.core.label="act3"/>
        <org.eventb.core.action name="_OiDAE-31Ee-riu9HV7xa5A" org.eventb.core.assignment="offersByCategory≔ offersByCategory   &#10;            {getActionCategory(offer)↦offersByCategory(getActionCategory(offer))∪{offer} }" org.eventb.core.comment="add new offer to its category" org.eventb.core.generated="false" org.eventb.core.label="act4"/>
        <org.eventb.core.guard name="_WOsCUO8LEe-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd5" org.eventb.core.predicate="requestedCapability ∈  Capability_valid ∨ requestedCapability=∅"/>
        <org.eventb.core.guard name="_ywAa0O8YEe-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd6" org.eventb.core.predicate="requestedCapability≠∅ ⇒ getActionCategory(requestedCapability)∈ dom(offersByCategory)"/>
    </org.eventb.core.event>
    <org.eventb.core.event name="_t077sOn5Ee-FCLy2ldeH6F" org.eventb.core.comment="remove offer from the current offers case: when offer is not in the response" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="removeOffer">
        <org.eventb.core.refinesEvent name="'" org.eventb.core.target="removeOffer"/>
        <org.eventb.core.parameter name="_Bou2IO63Ee-HGeEL2d3rFQ" org.eventb.core.comment="a service' offer described based on the capability model" org.eventb.core.generated="false" org.eventb.core.identifier="offer"/>
        <org.eventb.core.guard name="_BGVlsO3xEe-riu9HV7xa5A" org.eventb.core.comment="offer must be a valid capability" org.eventb.core.generated="false" org.eventb.core.label="grd1" org.eventb.core.predicate="offer ∈ Capability_valid"/>
        <org.eventb.core.guard name="_Bou2Ie63Ee-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd_wd" org.eventb.core.predicate="getActionCategory(offer)∈ dom(variantsOfByCategory)"/>
        <org.eventb.core.guard name="_BGVlse3xEe-riu9HV7xa5A" org.eventb.core.generated="false" org.eventb.core.label="grd_wd2" org.eventb.core.predicate="getActionCategory(offer)∈ dom(offersByCategory)"/>
        <org.eventb.core.guard name="_BGVlsu3xEe-riu9HV7xa5A" org.eventb.core.comment="offer belongs to offers" org.eventb.core.generated="false" org.eventb.core.label="grd2" org.eventb.core.predicate="offer ∈ offersByCategory(getActionCategory(offer))"/>
        <org.eventb.core.action name="_BGVls-3xEe-riu9HV7xa5A" org.eventb.core.assignment="offers≔ offers ∖{offer}" org.eventb.core.comment="remove offer from offers" org.eventb.core.generated="false" org.eventb.core.label="act1"/>
        <org.eventb.core.action name="_BGVltO3xEe-riu9HV7xa5A" org.eventb.core.assignment="variantsOf≔ variantsOf ∖ addNewVariantsOf(offers↦offer)" org.eventb.core.comment="remove links with offer from variantsOf" org.eventb.core.generated="false" org.eventb.core.label="act2"/>
        <org.eventb.core.action name="_BotA8O63Ee-HGeEL2d3rFQ" org.eventb.core.assignment="variantsOfByCategory≔ variantsOfByCategory   &#10;            {getActionCategory(offer)↦(variantsOfByCategory(getActionCategory(offer))∖addNewVariantsOf(offers↦offer)) }" org.eventb.core.comment="remove links with offer from the corresponding variantsOfByCategory" org.eventb.core.generated="false" org.eventb.core.label="act3"/>
        <org.eventb.core.action name="_BouPEO63Ee-HGeEL2d3rFQ" org.eventb.core.assignment="offersByCategory≔ offersByCategory   &#10;            {getActionCategory(offer)↦offersByCategory(getActionCategory(offer))∖{offer} }" org.eventb.core.comment="remove offer from the corresponding offersByCategory" org.eventb.core.generated="false" org.eventb.core.label="act4"/>
        <org.eventb.core.guard name="_BovdMO63Ee-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd3" org.eventb.core.predicate="offer ∉ response"/>
        <org.eventb.core.guard name="_BovdMe63Ee-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd4" org.eventb.core.predicate="∀a· a∈dom(variantsOfByCategory)⇒  a∈ dom(offersByCategory)"/>
    </org.eventb.core.event>
    <org.eventb.core.event name="_t077sOn5Ee-FCLy2ldeH6G" org.eventb.core.comment="remove offer when offer is in response and requestedCapability still in offers after removing offer" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="removeOfferWhenOfferIsInResponseAndEqualsRequest">
        <org.eventb.core.refinesEvent name="'" org.eventb.core.target="removeOfferWhenOfferIsInResponseAndEqualsRequest"/>
        <org.eventb.core.action name="_OiEOM-31Ee-riu9HV7xa5A" org.eventb.core.assignment="offers≔ offers ∖{offer}" org.eventb.core.comment="remove offer from offers" org.eventb.core.generated="false" org.eventb.core.label="act1"/>
        <org.eventb.core.action name="_OiEONO31Ee-riu9HV7xa5A" org.eventb.core.assignment="variantsOf≔ variantsOf ∖ addNewVariantsOf(offers↦offer)" org.eventb.core.comment="remove links with offer from variantsOf" org.eventb.core.generated="false" org.eventb.core.label="act2"/>
        <org.eventb.core.action name="_HLVDUO94Ee-HGeEL2d3rFQ" org.eventb.core.assignment="response≔ {requestedCapability}" org.eventb.core.generated="false" org.eventb.core.label="act3"/>
        <org.eventb.core.action name="_HLVDUe94Ee-HGeEL2d3rFQ" org.eventb.core.assignment="variantsOfByCategory≔ variantsOfByCategory   &#10;            {getActionCategory(offer)↦(variantsOfByCategory(getActionCategory(offer))∖addNewVariantsOf(offers↦offer)) }" org.eventb.core.comment="remove links with offer from the corresponding variantsOfByCategory" org.eventb.core.generated="false" org.eventb.core.label="act4"/>
        <org.eventb.core.action name="_OiDAFO31Ee-riu9HV7xa5A" org.eventb.core.assignment="offersByCategory≔ offersByCategory   &#10;            {getActionCategory(offer)↦offersByCategory(getActionCategory(offer))∖{offer} }" org.eventb.core.comment="remove offer from the corresponding offersByCategory" org.eventb.core.generated="false" org.eventb.core.label="act5"/>
        <org.eventb.core.guard name="_OiEOMO31Ee-riu9HV7xa5A" org.eventb.core.comment="offer must be a valid capability" org.eventb.core.generated="false" org.eventb.core.label="grd1" org.eventb.core.predicate="offer ∈ Capability_valid"/>
        <org.eventb.core.guard name="_HLVqYO94Ee-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd_wd" org.eventb.core.predicate="getActionCategory(offer)∈ dom(variantsOfByCategory)"/>
        <org.eventb.core.guard name="_OiEOMe31Ee-riu9HV7xa5A" org.eventb.core.generated="false" org.eventb.core.label="grd_wd2" org.eventb.core.predicate="getActionCategory(offer)∈ dom(offersByCategory)"/>
        <org.eventb.core.guard name="_OiEOMu31Ee-riu9HV7xa5A" org.eventb.core.comment="offer belongs to oofers" org.eventb.core.generated="false" org.eventb.core.label="grd2" org.eventb.core.predicate="offer ∈ offersByCategory(getActionCategory(offer))"/>
        <org.eventb.core.guard name="_HLWRcu94Ee-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd3" org.eventb.core.predicate="offer ∈  response"/>
        <org.eventb.core.parameter name="_HLVqYe94Ee-HGeEL2d3rFQ" org.eventb.core.comment="a service' offer described based on the capability model" org.eventb.core.generated="false" org.eventb.core.identifier="offer"/>
        <org.eventb.core.guard name="_HLWRc-94Ee-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd4" org.eventb.core.predicate="requestedCapability ∈ offers∖ {offer}"/>
    </org.eventb.core.event>
    <org.eventb.core.event name="_t077sOn5Ee-FCLy2ldeH6H" org.eventb.core.comment="remove offer when offer is in response and requestedCapability is not in offers∖ {offer}" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="removeOfferWhenOfferIsInResponseAndNotEqualToRequest">
        <org.eventb.core.refinesEvent name="'" org.eventb.core.target="removeOfferWhenOfferIsInResponseAndNotEqualToRequest"/>
        <org.eventb.core.parameter name="_HLVqYu94Ee-HGeEL2d3rFQ" org.eventb.core.comment="a service' offer described based on the capability model" org.eventb.core.generated="false" org.eventb.core.identifier="offer"/>
        <org.eventb.core.guard name="_BowEQO63Ee-HGeEL2d3rFQ" org.eventb.core.comment="offer must be a valid capability" org.eventb.core.generated="false" org.eventb.core.label="grd1" org.eventb.core.predicate="offer ∈ Capability_valid"/>
        <org.eventb.core.guard name="_HLWRcO94Ee-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd_wd" org.eventb.core.predicate="getActionCategory(offer)∈ dom(variantsOfByCategory)"/>
        <org.eventb.core.guard name="_BowEQe63Ee-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd_wd2" org.eventb.core.predicate="getActionCategory(offer)∈ dom(offersByCategory)"/>
        <org.eventb.core.guard name="_BowEQu63Ee-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd2" org.eventb.core.predicate="requestedCapability ∈  Capability_valid"/>
        <org.eventb.core.guard name="_HLWRce94Ee-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd_wd3" org.eventb.core.predicate="getActionCategory(requestedCapability)∈ dom(offersByCategory)"/>
        <org.eventb.core.guard name="_pYYigO94Ee-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd3" org.eventb.core.predicate="offer ∈ offersByCategory(getActionCategory(offer))"/>
        <org.eventb.core.action name="_BowEQ-63Ee-HGeEL2d3rFQ" org.eventb.core.assignment="offers≔ offers ∖{offer}" org.eventb.core.comment="remove offer from offers" org.eventb.core.generated="false" org.eventb.core.label="act1"/>
        <org.eventb.core.action name="_BowERO63Ee-HGeEL2d3rFQ" org.eventb.core.assignment="variantsOf≔ variantsOf ∖ addNewVariantsOf(offers↦offer)" org.eventb.core.comment="remove links with offer from variantsOf" org.eventb.core.generated="false" org.eventb.core.label="act2"/>
        <org.eventb.core.action name="_HLW4gO94Ee-HGeEL2d3rFQ" org.eventb.core.assignment="response≔  {offer0 ∣ offer0 ∈ offersByCategory(getActionCategory(requestedCapability))∖{offer} ∧ requestedCapability↦offer0 ∈ variantOf}" org.eventb.core.generated="false" org.eventb.core.label="act3"/>
        <org.eventb.core.guard name="_sGB8QO-_Ee-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd4" org.eventb.core.predicate="offer ∈  response"/>
        <org.eventb.core.guard name="_wojkgO94Ee-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd5" org.eventb.core.predicate="requestedCapability ∉ offersByCategory(getActionCategory(requestedCapability))∖ {offer}"/>
        <org.eventb.core.guard name="_TRGxoO_hEe-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd6" org.eventb.core.predicate="∀a· a∈dom(variantsOfByCategory)⇒  a∈ dom(offersByCategory)"/>
        <org.eventb.core.action name="_ZN0Y8O_nEe-HGeEL2d3rFQ" org.eventb.core.assignment="variantsOfByCategory≔ variantsOfByCategory   &#10;            {getActionCategory(offer)↦(variantsOfByCategory(getActionCategory(offer))∖addNewVariantsOf(offers↦offer)) }" org.eventb.core.comment="remove links with offer from the corresponding variantsOfByCategory" org.eventb.core.generated="false" org.eventb.core.label="act4"/>
        <org.eventb.core.action name="_ZN1AAO_nEe-HGeEL2d3rFQ" org.eventb.core.assignment="offersByCategory≔ offersByCategory   &#10;            {getActionCategory(offer)↦offersByCategory(getActionCategory(offer))∖{offer} }" org.eventb.core.comment="remove offer from the corresponding offersByCategory" org.eventb.core.generated="false" org.eventb.core.label="act5"/>
    </org.eventb.core.event>
    <org.eventb.core.event name="_t077sOn5Ee-FCLy2ldeH6I" org.eventb.core.comment="retrieve offers for a user request when request belongs to offers" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="getOffersForNewRequestWhenRequestIsInOffer">
        <org.eventb.core.refinesEvent name="'" org.eventb.core.target="getOffersForNewRequestWhenRequestIsInOffer"/>
        <org.eventb.core.parameter name="_ENt6gOrJEe-Y0dp7YSmiGQ" org.eventb.core.comment="described based on capability model" org.eventb.core.generated="false" org.eventb.core.identifier="request"/>
        <org.eventb.core.guard name="_HLW4ge94Ee-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd1" org.eventb.core.predicate="request ∈ Capability_valid"/>
        <org.eventb.core.guard name="_HLXfkO94Ee-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd_wd2" org.eventb.core.predicate="getActionCategory(request)∈ dom(offersByCategory)"/>
        <org.eventb.core.guard name="_HLXfke94Ee-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd2" org.eventb.core.predicate="request ∈  offersByCategory(getActionCategory(request))"/>
        <org.eventb.core.action name="_HLXfku94Ee-HGeEL2d3rFQ" org.eventb.core.assignment="requestedCapability ≔ request" org.eventb.core.generated="false" org.eventb.core.label="act1"/>
        <org.eventb.core.action name="_HLXfk-94Ee-HGeEL2d3rFQ" org.eventb.core.assignment="response≔ {request}" org.eventb.core.comment="∨  { request↦offer ∈ variantsOf})" org.eventb.core.generated="false" org.eventb.core.label="act2"/>
    </org.eventb.core.event>
    <org.eventb.core.event name="_t077sOn5Ee-FCLy2ldeH6J" org.eventb.core.comment="retrieve offers when request does not belong to offers" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="getOffersForNewRequestWhenRequestIsNotInOffer">
        <org.eventb.core.refinesEvent name="'" org.eventb.core.target="getOffersForNewRequestWhenRequestIsNotInOffer"/>
        <org.eventb.core.parameter name="_ENt6gerJEe-Y0dp7YSmiGQ" org.eventb.core.comment="described based on capability model" org.eventb.core.generated="false" org.eventb.core.identifier="request"/>
        <org.eventb.core.guard name="_HLXflO94Ee-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd1" org.eventb.core.predicate="request ∈ Capability_valid"/>
        <org.eventb.core.guard name="_HLXfle94Ee-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd_wd2" org.eventb.core.predicate="getActionCategory(request)∈ dom(offersByCategory)"/>
        <org.eventb.core.guard name="_HLXflu94Ee-HGeEL2d3rFQ" org.eventb.core.generated="false" org.eventb.core.label="grd2" org.eventb.core.predicate="request ∉  offersByCategory(getActionCategory(request))"/>
        <org.eventb.core.action name="_HLYGoO94Ee-HGeEL2d3rFQ" org.eventb.core.assignment="requestedCapability ≔ request" org.eventb.core.generated="false" org.eventb.core.label="act1"/>
        <org.eventb.core.action name="_HLYGoe94Ee-HGeEL2d3rFQ" org.eventb.core.assignment="response≔ {offer ∣ offer ∈ offersByCategory(getActionCategory(request)) ∧ request↦offer ∈ variantOf}" org.eventb.core.generated="false" org.eventb.core.label="act2"/>
    </org.eventb.core.event>
    <org.eventb.core.invariant name="_t077sOn5Ee-FCLy2ldeH6K" org.eventb.core.comment="variantsOfByCategory is a partial relation from a subset of GENERALVALUES to a subset of variantOf" org.eventb.core.generated="false" org.eventb.core.label="inv1" org.eventb.core.predicate="variantsOfByCategory ∈ ℙ(GENERALVALUES)⇸ ℙ(variantOf)"/>
    <org.eventb.core.invariant name="_t077sOn5Ee-FCLy2ldeH6L" org.eventb.core.comment="the union of subgraphs' edges is the edges of the global graph" org.eventb.core.generated="false" org.eventb.core.label="inv2" org.eventb.core.predicate="union(ran(variantsOfByCategory))=variantsOf"/>
    <org.eventb.core.invariant name="_vCbloOvSEe-Y0dp7YSmiGQ" org.eventb.core.comment="offersByCategory is a partial relation from a subset of GENERALVALUES to a subset of offers" org.eventb.core.generated="false" org.eventb.core.label="inv3" org.eventb.core.predicate="offersByCategory ∈ ℙ(GENERALVALUES)⇸ ℙ(Capability_valid)"/>
    <org.eventb.core.invariant name="_uJUiIOq7Ee-Y0dp7YSmiGQ" org.eventb.core.comment="if a is a value for the actionCategory property(a is subset of GENERALVALUES) and&#10;  c is an offer that belongs to offersByCategory(a) then the value of the actionCategory property of c is equals to a. This means all elements in the same offersByCategory(a),&#10;  the value of their actionCategory property is a   " org.eventb.core.generated="false" org.eventb.core.label="inv4" org.eventb.core.predicate="∀a,c·  a ∈ dom(offersByCategory) ∧ c ∈ offersByCategory(a) ⇒  getActionCategory(c)=a"/>
    <org.eventb.core.variable name="_O7TGYOusEe-Y0dp7YSmiGQ" org.eventb.core.comment="&#10;             this is the second refinement:&#10;             decomposition of offers by category and variantsOf by categorys. Now we have a global graph G(offers,variantsOf)&#10;             where offers represent the nodes of G and variantsOf are the set of edges&#10;             and subGraphs for each each actionCategory&#10;             g_action_i(offersByCategory(action_i),(variantsOfByCategory(action_i))&#10;            where offersByCategory(action_i) represent the nodes of g_action_i and variantsOfByCategory(action_i)&#10;             are the set of edges of g_action_i&#10;              &#10;terminology : variantsOf: all variantOf relationships between offers we can call it also edges of global graph " org.eventb.core.generated="false" org.eventb.core.identifier="offersByCategory"/>
    <org.eventb.core.invariant name="_LxUnYOyhEe-riu9HV7xa5A" org.eventb.core.comment="the union of subgraphs' nodes is the set of global nodes(offers)" org.eventb.core.generated="false" org.eventb.core.label="inv5" org.eventb.core.predicate="union(ran(offersByCategory))=offers"/>
    <org.eventb.core.invariant name="_BPOIMOu9Ee-Y0dp7YSmiGQ" org.eventb.core.comment="the set of edges for each subgraph is the set of edges in the global graph where nodes are in the same subgraph" org.eventb.core.generated="false" org.eventb.core.label="inv7" org.eventb.core.predicate="∀a· a ∈ ℙ(GENERALVALUES) ∧ a ∈ dom(variantsOfByCategory)∧ a ∈ dom(offersByCategory)&#10; &#9;&#9; ⇒ variantsOfByCategory(a)={c1↦c2∣c1 ∈ offersByCategory(a) ∧ c2∈ offersByCategory(a) ∧&#10;  &#9;&#9;&#9; c1↦c2 ∈ variantsOf}"/>
    <org.eventb.core.invariant name="_gIV8AOu-Ee-Y0dp7YSmiGQ" org.eventb.core.comment="in inv4a in m1 requestedCapability ∈ offers becomes requestedCapability ∈ offersByCategory having as actionCategory the same as requestCapability" org.eventb.core.generated="false" org.eventb.core.label="inv8" org.eventb.core.predicate="requestedCapability≠∅ ∧ getActionCategory(requestedCapability) ∈ dom(offersByCategory) ∧&#10;  requestedCapability ∈ offersByCategory(getActionCategory(requestedCapability)) ⇒ response = {requestedCapability}"/>
    <org.eventb.core.invariant name="_SPaFIOyhEe-riu9HV7xa5A" org.eventb.core.comment="in inv4b in M1 requestedCapability∉ offers becomes requestedCapability∉ offersByCategory having the same actionCategory as the requestedCapability" org.eventb.core.generated="false" org.eventb.core.label="inv9" org.eventb.core.predicate="requestedCapability≠∅ ∧ getActionCategory(requestedCapability) ∈ dom(offersByCategory) ∧&#10;  requestedCapability ∉ offersByCategory(getActionCategory(requestedCapability))  ⇒&#10;  response ={offer ∣ offer ∈ offersByCategory(getActionCategory(requestedCapability)) ∧&#10;  requestedCapability↦offer ∈ variantOf}"/>
    <org.eventb.core.invariant name="_7wTMEO8XEe-HGeEL2d3rFQ" org.eventb.core.comment="request is empty or s valid capability" org.eventb.core.generated="false" org.eventb.core.label="inv10" org.eventb.core.predicate="requestedCapability= ∅ ∨ requestedCapability ∈ Capability_valid"/>
    <org.eventb.core.invariant name="_EZ-asevCEe-Y0dp7YSmiGQ" org.eventb.core.comment="intersection between offersByCategory is the empty set" org.eventb.core.generated="false" org.eventb.core.label="inv11" org.eventb.core.predicate="∀a,b· a∈ℙ(GENERALVALUES)∧ b∈ℙ(GENERALVALUES)∧&#10;                 a∈ dom(offersByCategory)∧ b∈ dom(offersByCategory)&#10;                 ⇒(a≠b⇒offersByCategory(a)∩offersByCategory(b)=∅)" org.eventb.core.theorem="true"/>
    <org.eventb.core.invariant name="_d8kvAPBTEe-HGeEL2d3rFQ" org.eventb.core.comment="intersection between variantsOfByCategory is the empty set&#10;@inv5 and @inv11 prove that each offersByCategory is a partition of offers&#10;@inv2 and @inv12 prove that each variantsOfByCategory is a partition of variants&#10;Thus the global graph is decomposed into many subgraphs that are disconnected and we proved the global graph is the composition of all subgraphs" org.eventb.core.generated="false" org.eventb.core.label="inv12" org.eventb.core.predicate="∀a,b· a∈ℙ(GENERALVALUES)∧ b∈ℙ(GENERALVALUES)∧&#10;                 a∈ dom(variantsOfByCategory)∧ b∈ dom(variantsOfByCategory)∧a∈ dom(offersByCategory)∧ b∈ dom(offersByCategory)&#10;                 ⇒(a≠b⇒variantsOfByCategory(a)∩variantsOfByCategory(b)=∅)" org.eventb.core.theorem="true"/>
</org.eventb.core.machineFile>
